(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{1179:function(t,e,n){"use strict";var r=n(394);n.n(r).a},1180:function(t,e,n){(t.exports=n(3)(!1)).push([t.i,".image_patina .nya-subtitle{margin-top:.9375rem}.image_patina .vue-slider{margin-bottom:.9375rem}.image_patina .preview{width:100%;font-size:0;display:flex;justify-content:space-between}.image_patina .preview .nya-subtitle{padding:0}.image_patina .preview div{width:50%;padding:0 1.25rem;box-sizing:border-box;display:inline-block}@media (max-width:600px){.image_patina .preview{display:block}.image_patina .preview div{width:100%;display:block}}.image_patina .preview img{width:100%}",""])},1555:function(t,e,n){"use strict";n.r(e);n(339);var r=n(333),o={name:"ImagePatina",head:function(){return this.$store.state.currentTool.head},components:{VueSlider:n(340)},data:function(){return{n:null,file:null,progress:0,iterations:16,quality:75,image:null,preview:"",resultsImg:"",requestIn:!1}},computed:{},watch:{quality:function(){this.resetProcess()}},mounted:function(){this.cover()},methods:{handleChange:function(t){var e=this,n=t.target.files;if(!n.length)return!1;var r=n[0];this.file=r;var o=new FileReader;o.readAsDataURL(r),o.addEventListener("load",function(){e.preview=o.result,e.resetProcess()},!1)},download:function(){if(this.image.src){var t=this.n.lastIndexOf("."),e=(-1==t?this.n:this.n.substring(0,t))+(this.quality<=100?"_JPEGreen.jpg":"_JPEGreen.png");Object(r.a)(this.image.src,e)}},cover:function(){var t=this;this.image=new Image,this.image.addEventListener("load",function(){requestAnimationFrame(t.processImage)})},update:function(){this.progress<=this.iterations?requestAnimationFrame(this.processImage):this.resetProcess()},resetProcess:function(){this.progress=0,this.image.src=this.preview},processImage:function(){this.requestIn=!0;var t=function(t){return t>=0?t<=255?t:255:0},e=function(t){return t>=-128?t<=127?t:127:-128},canvas=document.createElement("canvas"),n=canvas.getContext("2d");if(this.progress!=this.iterations){++this.progress,canvas.width=this.image.width,canvas.height=this.image.height,n.fillStyle="white",n.fillRect(0,0,this.image.width,this.image.height),n.drawImage(this.image,0,0);for(var r=n.getImageData(0,0,this.image.width,this.image.height),data=r.data,p=0;p<data.length/4;++p){var o=data[4*p],g=data[4*p+1],b=data[4*p+2],l=t(77*o+150*g+29*b>>8),u=e((-43*o-85*g+128*b>>8)-1),c=e((128*o-107*g-21*b>>8)-1),h=t(65536*l+91881*c>>16),m=t(65536*l-22553*u-46802*c>>16),d=t(65536*l+116130*u>>16);data[4*p]=h,data[4*p+1]=m,data[4*p+2]=d}n.putImageData(r,0,0);var v=this.quality<=100?canvas.toDataURL("image/jpeg",.01*this.quality):canvas.toDataURL("image/png");this.resultsImg=v,this.image.src=v}else this.requestIn=!1}}},l=(n(1179),n(2)),component=Object(l.a)(o,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"image_patina"},[n("nya-container",{attrs:{title:"图片加包浆"}},[n("div",{staticClass:"inputbtn"},[n("nya-input",{staticClass:"upfile",attrs:{type:"file",accept:"image/*",label:"请选择要处理的图片",placeholder:"点击这里上传文件"},on:{change:t.handleChange},model:{value:t.n,callback:function(e){t.n=e},expression:"n"}}),t._v(" "),n("button",{staticClass:"nya-btn",attrs:{type:"button"},on:{click:t.download}},[t._v("\n                "+t._s(t.requestIn?(t.progress/t.iterations*100).toFixed(0)+" %":"保存")+"\n            ")])],1),t._v(" "),n("div",{staticClass:"nya-subtitle"},[t._v("\n            图片质量\n        ")]),t._v(" "),n("no-ssr",[n("vue-slider",{attrs:{lazy:"",min:0,max:100},model:{value:t.quality,callback:function(e){t.quality=e},expression:"quality"}})],1),t._v(" "),n("nya-input",{attrs:{type:"number",label:"包浆次数",autocomplete:"off",fullwidth:""},on:{change:t.update},model:{value:t.iterations,callback:function(e){t.iterations="string"==typeof e?e.trim():e},expression:"iterations"}})],1),t._v(" "),t.preview?n("nya-container",{attrs:{title:"预览"}},[n("div",{staticClass:"preview"},[n("div",[n("div",{staticClass:"nya-subtitle"},[t._v("\n                    处理前\n                ")]),t._v(" "),n("img",{attrs:{src:t.preview,alt:"image"}})]),t._v(" "),n("div",[n("div",{staticClass:"nya-subtitle"},[t._v("\n                    处理后\n                ")]),t._v(" "),n("img",{attrs:{src:t.resultsImg,alt:"image"}})])])]):t._e(),t._v(" "),n("nya-container",{attrs:{title:"说明"}},[n("ul",{staticClass:"nya-list"},[n("li",[t._v("为什么要写这个功能可以参考："),n("a",{attrs:{href:"https://www.zhihu.com/question/29345490",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.zhihu.com/question/29345490")])]),t._v(" "),n("li",[t._v("新做的表情包没人用？表情包没有年代感？这时即可使用本工具把图片做旧，让表情包看起来传播次数更多，更有收藏价值")]),t._v(" "),n("li",[t._v("如果处理时间过长或处理失败，请使用其他浏览器，推荐使用 Chrome")])])])],1)},[],!1,null,null,null);e.default=component.exports},333:function(t,e,n){"use strict";e.a=function(t,e){var a=document.createElement("a");a.href=t,a.download=e,a.click()}},394:function(t,e,n){var content=n(1180);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(4).default)("9272b666",content,!0,{sourceMap:!1})}}]);